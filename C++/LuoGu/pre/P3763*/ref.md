# P3763 [解题思路](https://www.luogu.com.cn/blog/35891/solution-p3763)

题意：

给出两个长度小于\*\* **105**1**0**5** 的字符串** **S**S** 和** **T**T**，求** **S**S** 中有多少个连续子串在不改变超过** **3**3** 个字符后可以和** **T**T** 匹配。多组数据，字符集大小为** **4**4\*\*。

---

设\*\* **S**S** 的长度为** **n**n**，** **T**T** 的长度为** **m**m\*\*。

字符集大小为\*\* **4**4\*\*，考虑对每个字符分开考虑。

样例：

S: ATCGCCCTA**S**:\*\* \*\*ATCGCCCTA

T: CTTCA**T**:\*\* \*\*CTTCA

不妨先对字符\*\* **C**C** 进行处理。将** **S**S** 和** **T**T** 中为** **C**C** 的位置变为** **1**1** ，不为** **C**C** 的位置变为** **0**0\*\* 再进行匹配。

S: 001011100**S**:\*\* \*\*001011100

T: 10010**T**:\*\* \*\*10010

那么对于某个位置\*\* **k**k**，** **S[k ... k+m−1]**S**[**k\*\* **.**.**.** **k**+**m**−**1**]\*\* **和** **T[0 ... m−1]**T**[**0\*\* **.**.**.** **m**−**1**]\*\* \*\*的匹配个数可以写为：

∑i=0m−1S[i+k]T[i]**i**=**0**∑**m**−**1\*\***S**[**i**+**k**]**T**[**i\*\*]

然后我们发现这个式子特别像 FFT，于是进行一番处理：

设\*\* **A[m−i−1]=T[i]**A**[**m**−**i**−**1**]**=**T**[**i**]\*\*

上式变为：

∑i=0m−1S[i+k]A[m−i−1]**i**=**0**∑**m**−**1\*\***S**[**i**+**k**]**A**[**m**−**i**−**1\*\*]

∑i+j=m−k−1S[i]A[j]**i**+**j**=**m**−**k**−**1**∑\***\*S**[**i**]**A**[**j**]\*\*

然后跑 FFT 就可以快速求出上式。

最后位置\*\* **S[k ... k+m−1]**S**[**k\*\* **.**.**.** **k**+**m**−**1**]\*\* **和** **T[0 ... m−1]**T**[**0\*\* **.**.**.** **m**−**1**]\*\* \*\*的匹配个数就是这四次 FFT 结果相加。

因为可以修改三个位置，最后判断是否匹配可以有\*\* **3**3\*\* 的误差

### 样例输入 #1

```
1
ATCGCCCTA
CTTCA
```

### 样例输出 #1

```
2
```

假定样例中，S 与 T 每一位上 C 的位置都为 1，其余位置为 0，则有：

```
001011100
10010
```
